<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Portfolio and Blog">
  <meta name="author" content="Lenix Carter">
  <title>Dorsal-Palmar Hand Matching</title>

  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
</head>
<body>

  <header>
      <div class="title-container">
        <div class="title">Lenix Carter</div>
        <div class="subtitle">ML Engineer</div>
      </div>
  </header>

  <main>
      <div class="spec-box black">
      <div class="spec-tab"> Dorsal-Palmar Hand Matching</div>
        
          <div class="spec-box red">
          <div class="spec-tab"> Summary </div>
            <div class="spec-content">
                Given the back of someone's hand, can you reliably identify their palm?
            </div>
          </div>
        
        <div class="spec-content">
            <h2 id="problem">Problem</h2>
<p>If I showed you one photo of the back of someone’s hand, could you pick out their
palm from a lineup? You might respond, of course not, I’ve never seen their 
palm and what a palm looks like isn’t clear from what the back of a hand looks
like! Then you see the challenge. 
I was curious, in the field of identification, how effective can we be with
cross-view learning. A dataset that allowed me to expose that quite cleanly was
the 11k Hands dataset. Photos include left/right, dorsal/palmar, fingers 
closed/opened. This is a summation of my thoughts and decision making, rather
than a technical document, for that read the 
<a href="https://github.com/LenixC/Hands-Cross-View">README.</a></p>

<h2 id="architecture">Architecture</h2>
<p>I wanted to establish a baseline with a simple but effective mode, for two reasons.
Firstly, I have often found that the baseline is good enough for many problems,
not everything needs a neural net, and often the cost of inference or training
make it unfeasible or the juice just isn’t worth the squeeze. Secondly, 
when we have a good model, it is also good to know how good that model is, if
you’ll excuse the good-ness. While we can compare to a random guessing model,
I find that often isn’t particularly informative, because it doesn’t say how
solvable a problem is.</p>

<h3 id="resnet50--contrastive-loss">ResNet50 + Contrastive Loss</h3>
<p>My baseline then, is simply a ResNet50 encoder as a twin network with contrastive
loss. For this problem, we simply randomly choose positive sample pairs and
negative sample pairs, and use contrastive loss to pull positives together and
push negatives apart in the space. The way to think about these encoding problems
is simply, does this make sense as a spatial problem, and how do well represent the
space. The simplicity of this architecture makes it pretty clear that this is a
spatial problem, and we can represent this space by having this sort of shared
universe of palmar and dorsal photos where we are trying to pack together these
cross-view sets.</p>

<p>This technique performed quite admirably, though admittedly with some fussing in
the beginning. When given the dorsal photo, the mean rank of the true palmar photo
is roughly 12, meaning that the 12th closest point was correct. Additionally, we 
measured Recall@k and got k=1 of 9.8%, k=5 of 41.5%, and k=10 of 63.4%. So, 10%
of the time, we got the problem exactly right. This might not sound very 
impressive, but this is a truly challenging problem space in practice. I want you
to imagine how hard it would be to identify the palm of someone hand, having only
seen one photo of the back it. It wouldn’t be easy.</p>

<h3 id="dinov2--triplet-loss--hard-negative-mining">DINOv2 + Triplet Loss + Hard Negative Mining</h3>
<p>My second model was to use the DINOv2 vision transformer to attempt to take 
advantage of some of the increased capabilities to identify actually meaningful
features as a benefit of using a pretrained model. Additionally, Hard Negative
Mining was chosen as a literature-backed default for this sort of problem. 
Hard Negative Mining lets us focus on the distinctions between good matches and
bad matches more directly.
Triplet loss is beneficial because it directly optimizes for the ranking element, 
which in our problem is the key. We want better guesses better ranked.</p>

<p>This technique, as I certainly hoped, did much, much better than my baseline.
Achieving a mean rank of 2.5, and recalls@k of 61%, 90%, and 95% for k=1, 5, 10
respectively. This is obviously a huge improvement, however, it comes with the 
cost of training time (though not unreasonable) and inference speed. Likely, I 
wouldn’t be using this technique, if query latency were a factor, but the 
performance is hard to beat.</p>

<h2 id="improvements">Improvements</h2>
<p>In addition to the computational challenges listed in the README, I’d be 
interested in seeing what can be done by augmenting the current data. If we added
some photometric variations to simulate different lighting conditions, rotations, 
translations, can we improve the generalizability of the model? Would this 
translate to better recall@k?</p>

<h2 id="future-work">Future Work</h2>
<p>I want to experiment with more models and more compute, or I’d encourage you to 
extend the problem in the same way. Further experimentation should certainly be
done on augmenting the data or perhaps finding an even larger dataset
for the problem. I also would like to write a tutorial on this,
and actually make some visual explainers of how things like contrastive loss 
compares philosophically with HNMining and triplet loss.</p>

        </div>
      </div>
  </main>

  <footer>
    <p>&copy; 2026 Lenix Carter. All rights reserved.</p>
  </footer>

  <script src="/assets/js/script.js"></script>
</body>
</html>
